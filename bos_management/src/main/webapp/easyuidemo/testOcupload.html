<!DOCTYPE html>
<html>

	<head>
		<meta charset="UTF-8">
		<title>上传文件</title>
		<script type="text/javascript" src="../js/jquery-1.8.3.js"></script>
		<!-- 导入ocupload -->
		<script type="text/javascript" src="../js/ocupload/jquery.ocupload-1.1.2.js"></script>
		<script>
			// 为导入按钮，添加一键上传效果 
			$(function() {
				$("#btn").upload({
					// 默认name为file 
					action: '../test_ocupload.action',
					name: 'file3',
					params: {
						'param1': 'value1',
						'param2': 'value2',
						'rand': Math.random()
					},
					onSelect: function() {
						// 选中文件后，关闭自动提交 
						this.autoSubmit = false;
						// 判定文件格式 ，以.xls 或者 .xlsx 结尾 
						var filename = this.filename();
						var regex = /^.*\.(xls|xlsx)$/;
						if(regex.test(filename)) {
							// 满足
							this.submit();
						} else {
//							$.messager.alert("警告", "只能上传.xls或.xlsx结尾的文件！", "warning");
							alert('哈哈哈');
						}
					},
					onComplete: function(response) {
						//			    		alert("文件上传成功！");
						// 刷新列表 
						$("#grid").datagrid('reload');
						alert("文件上传成功！");
					}
				});
			});
		</script>

	</head>

	<body>
		<input type="button" id="btn" value="一键上传" />
	</body>

</html>